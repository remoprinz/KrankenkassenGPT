# Generated by SwissHealth API
# Multi-stage Dockerfile for MCP Server

# Build stage
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
COPY tsconfig.json ./
COPY src ./src
RUN npm install
RUN npm run build

# Production stage
FROM node:20-alpine
WORKDIR /app
COPY --from=builder /app/build ./build
COPY --from=builder /app/package*.json ./
RUN npm ci --only=production

# Environment variables needed at runtime
ENV NODE_ENV=production

# User must provide these at runtime
# ENV SUPABASE_URL=...
# ENV SUPABASE_SERVICE_ROLE_KEY=...

ENTRYPOINT ["node", "build/index.js"]
